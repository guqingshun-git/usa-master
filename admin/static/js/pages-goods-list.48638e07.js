(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-goods-list"],{"017b":function(t,e,a){"use strict";a.r(e);var i=a("2cb9"),n=a("15b4");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("bc3a");var l=a("828b"),s=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"03b27407",null,!1,i["a"],void 0);e["default"]=s.exports},"080b":function(t,e,a){var i=a("edde");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("967d").default;n("5c38492e",i,!0,{sourceMap:!1,shadowMode:!1})},"15b4":function(t,e,a){"use strict";a.r(e);var i=a("8843"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},"1dcc":function(t,e,a){"use strict";var i=a("db7c"),n=a.n(i);n.a},"1eac":function(t,e,a){"use strict";a.r(e);var i=a("c314"),n=a("924c");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);var l=a("828b"),s=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"b09caaf8",null,!1,i["a"],void 0);e["default"]=s.exports},2994:function(t,e,a){"use strict";var i=a("ce6d"),n=a.n(i);n.a},"2cb9":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return i}));var i={vkDataMobilePreview:a("fde9").default},n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vk-data-drawer",{attrs:{title:t.page.title,top:t.page.top,width:t.page.width,"close-on-click-modal":!0},on:{open:function(e){arguments[0]=e=t.$handleEvent(e),t.onOpen.apply(void 0,arguments)},closed:function(e){arguments[0]=e=t.$handleEvent(e),t.onClose.apply(void 0,arguments)}},model:{value:t.value.show,callback:function(e){t.$set(t.value,"show",e)},expression:"value.show"}},[a("vk-data-mobile-preview",{attrs:{type:t.mobile.type,url:t.value.url}}),a("v-uni-view",{staticClass:"preview-drawer-btn"},[a("v-uni-button",{staticClass:"el-button table-btn el-button--default is-round",class:{active:"iphone"===t.mobile.type},attrs:{type:"button"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.mobile.type="iphone"}}},[a("span",[t._v("iphone")])]),a("v-uni-button",{staticClass:"el-button table-btn el-button--default is-round",class:{active:"iphonex"===t.mobile.type},attrs:{type:"button"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.mobile.type="iphonex"}}},[a("span",[t._v("iphonex")])]),a("v-uni-button",{staticClass:"el-button table-btn el-button--default is-round",class:{active:"qrcode"===t.mobile.type},attrs:{type:"button"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.mobile.type="qrcode"}}},[a("span",[t._v("二维码")])]),a("v-uni-button",{staticClass:"el-button return-btn el-button--default is-round",attrs:{type:"button"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.close.apply(void 0,arguments)}}},[a("i",{staticClass:"el-icon-back"}),a("span",[t._v("返回")])])],1)],1)},o=[]},"32f1":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vk-data-dialog",{attrs:{title:t.page.title,top:t.page.top,width:t.page.width,"close-on-click-modal":!0,mode:"form"},on:{open:function(e){arguments[0]=e=t.$handleEvent(e),t.onOpen.apply(void 0,arguments)},closed:function(e){arguments[0]=e=t.$handleEvent(e),t.onClose.apply(void 0,arguments)}},model:{value:t.value.show,callback:function(e){t.$set(t.value,"show",e)},expression:"value.show"}},[a("vk-data-form",{ref:"form1",attrs:{"form-type":t.value.mode,rules:t.form1.props.rules,action:t.form1.props.action,columns:t.form1.props.columns,loading:t.form1.props.loading,labelWidth:t.form1.props.labelWidth,"show-cancel":t.page.showCancel,"cancel-text":t.page.cancelText,"submit-text":t.page.submitText},on:{"update:loading":function(e){arguments[0]=e=t.$handleEvent(e),t.$set(t.form1.props,"loading",e)},success:function(e){arguments[0]=e=t.$handleEvent(e),t.onFormSuccess.apply(void 0,arguments)}},model:{value:t.form1.data,callback:function(e){t.$set(t.form1,"data",e)},expression:"form1.data"}})],1)},n=[]},"3b9b":function(t,e,a){"use strict";a.r(e);var i=a("32f1"),n=a("fe66");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);var l=a("828b"),s=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"1957af48",null,!1,i["a"],void 0);e["default"]=s.exports},"3c68":function(t,e,a){"use strict";a.r(e);var i=a("f251"),n=a("a143");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);var l=a("828b"),s=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"301d6190",null,!1,i["a"],void 0);e["default"]=s.exports},"48c6":function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".uni-item[data-v-475b9fbb]{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1;flex:1;background-color:#f8f8f8}",""]),t.exports=e},"4f6b":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vk-data-dialog",{attrs:{title:t.page.title,top:"2vh",center:!0,width:"1200px","close-on-click-modal":!0},on:{open:function(e){arguments[0]=e=t.$handleEvent(e),t.onOpen.apply(void 0,arguments)},closed:function(e){arguments[0]=e=t.$handleEvent(e),t.onClose.apply(void 0,arguments)}},model:{value:t.value.show,callback:function(e){t.$set(t.value,"show",e)},expression:"value.show"}},[a("v-uni-view",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"page-body"},[a("vk-data-form",{ref:"form1",attrs:{rules:t.formData1.rules,action:t.formData1.action,"form-type":t.value.mode,columns:t.formData1.columns,"label-width":"80px",loading:t.formData1.loading},on:{"update:loading":function(e){arguments[0]=e=t.$handleEvent(e),t.$set(t.formData1,"loading",e)},success:function(e){arguments[0]=e=t.$handleEvent(e),t.onFormSuccess.apply(void 0,arguments)}},scopedSlots:t._u([{key:"name",fn:function(e){e.form,e.keyName;var i=e.val;return[a("v-uni-view",{staticClass:"goods_name"},[a("v-uni-text",[t._v(t._s(i))])],1)]}},{key:"spec_list",fn:function(e){var i=e.form,n=(e.keyName,e.val);return[a("v-uni-view",{staticClass:"spec_list",style:"width:"+(160*t.titleArr.length+20)+"px"},[a("v-uni-view",{staticClass:"spec_list_header"},t._l(t.titleArr,(function(e,i){return a("v-uni-text",{key:i},[t._v(t._s(e))])})),1),t._l(i.sku_list,(function(e,o){return a("v-uni-view",{key:"sku-"+o,staticClass:"spec_list_body"},[t._l(n,(function(i,n){return i.name?a("v-uni-text",{key:"val-"+n},[t._v(t._s(e.sku_name_arr[n]))]):t._e()})),a("v-uni-text",[t._v(t._s(t._f("priceFilter")(e.price)))]),t._l(e.vip_price_rules,(function(e,n){return a("v-uni-view",{key:"vip-"+e._id,staticClass:"discount_price"},[i.is_fixed_calc?a("vk-data-input-money",{attrs:{"right-text":"元",clearable:!1},model:{value:e.fixed_value,callback:function(a){t.$set(e,"fixed_value",a)},expression:"item3.fixed_value"}}):a("vk-data-input-discount",{attrs:{clearable:!1},model:{value:e.proportion_value,callback:function(a){t.$set(e,"proportion_value",a)},expression:"item3.proportion_value"}})],1)}))],2)}))],2)]}},{key:"footer",fn:function(e){var i=e.loading;return[a("el-button",{staticStyle:{width:"80px"},attrs:{loading:i,type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submitForm.apply(void 0,arguments)}}},[t._v(t._s(t.page.submitText))]),a("el-button",{staticStyle:{"margin-left":"20px",width:"80px"},attrs:{plain:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.pageBack.apply(void 0,arguments)}}},[t._v("关闭")])]}}]),model:{value:t.form1,callback:function(e){t.form1=e},expression:"form1"}})],1)],1)},n=[]},"5e10":function(t,e,a){"use strict";var i;a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("fd3c");var n=uni.vk,o={props:{value:{type:Object,default:function(){return{show:!1,mode:"",item:{}}}}},data:function(){return{unifiedStock:"",loadingSave:!1,page:{title:"商品库存",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"14vh",width:"400px"},form1:{data:{sku_list:[]},props:{}}}},mounted:function(){i=this,i.init()},methods:{init:function(){var t=i,e=t.value;i.$emit("input",e)},onOpen:function(){i=this;var t=i.value.item,e=void 0===t?{}:t;i.form1.data=n.pubfn.copyObject(e)},onClose:function(){},onFormSuccess:function(){i.value.item.sku_list=n.pubfn.copyObject(i.form1.data.sku_list),i.value.show=!1,i.$emit("success")},submitForm:function(){n.callFunction({url:"admin/sys.goods.updateGoodsSkuStock",loading:{that:i,name:"loadingSave"},data:{_id:i.form1.data._id,sku_list:i.form1.data.sku_list},success:function(t){i.$message({message:"操作成功!",type:"success"}),i.onFormSuccess()}})},allStockSet:function(){n.pubfn.isNotNull(i.unifiedStock)&&i.form1.data.sku_list.map((function(t,e){t.stock=i.unifiedStock}))}},watch:{},computed:{stockCom:function(){var t=0,e=this.form1.data.sku_list,a=void 0===e?[]:e;return a.map((function(e,a){t+=e.stock})),t}}};e.default=o},"61e0":function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,"uni-view[data-v-4bc3da54], uni-text[data-v-4bc3da54]{-webkit-box-sizing:border-box;box-sizing:border-box}.spec_list_header[data-v-4bc3da54]{background-color:#f5f7fa}.spec_list_header[data-v-4bc3da54],\n.spec_list_body[data-v-4bc3da54]{display:grid;grid-template-columns:repeat(auto-fill,160px);border:1px solid #f5f7fa}.spec_list_header > uni-text[data-v-4bc3da54],\n.spec_list_body > uni-text[data-v-4bc3da54]{width:100%;height:100%;border-right:1px solid #f5f7fa;padding-left:10px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.spec_list_header .discount_price[data-v-4bc3da54],\n.spec_list_body .discount_price[data-v-4bc3da54]{place-self:center;border-radius:4px;width:90%;height:70%}.spec_list_body[data-v-4bc3da54]{border-top:none;overflow:auto;grid-template-rows:repeat(auto-fill,50px);-webkit-transition:all .3s;transition:all .3s}.spec_list_body[data-v-4bc3da54]:hover{background-color:#f5f7fa}",""]),t.exports=e},6981:function(t,e,a){"use strict";a.r(e);var i=a("5e10"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},7230:function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".page-body .sort-input[data-v-60694df3]{font-size:12px}.page-body[data-v-60694df3]  .el-tree-node__content{height:40px;font-weight:600}.page-body .group-badge[data-v-60694df3]  .el-badge__content.is-fixed{z-index:2;right:20px;text-align:right}",""]),t.exports=e},"723d":function(t,e,a){"use strict";a.r(e);var i=a("d840"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},"79c8":function(t,e,a){var i=a("7230");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("967d").default;n("2f1dea9e",i,!0,{sourceMap:!1,shadowMode:!1})},"85ff":function(t,e,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,o=i(a("9b1b")),l=uni.vk,s={is_custom:0,regional_reward_multiple:1,share_reward_1:{is_calc:!0,is_fixed_calc:!1,proportion_value:"",fixed_value:"",is_level_k:!0},share_reward_2:{is_calc:!0,is_fixed_calc:!1,proportion_value:"",fixed_value:"",is_level_k:!0}},r={props:{value:{type:Object,default:function(){return{show:!1,mode:"",item:{}}}}},data:function(){return{page:{title:"设置该商品奖励应用此单独规则",submitText:"设置",cancelText:"关闭",showCancel:!0,top:"0.5vh",width:"1100px"},form1:{data:{tableList:[]},props:{action:"admin/sys.goods.updateRewardRule",columns:[{key:"is_custom",title:"是否开启自定义",type:"radio",optionType:"button",data:[{value:0,label:"使用默认规则"},{value:1,label:"开启自定义"},{value:-1,label:"关闭奖励"}]},{key:"regional_reward_multiple",title:"区域奖励倍数",type:"number",placeholder:"输入倍数",width:160,clearable:!1,max:100,rightText:"倍",showRule:"is_custom=1"},{key:"tableList",title:"分销奖励",type:"array<object>",showLabel:!1,showAdd:!1,showClear:!1,showSort:!1,rowNo:!1,rowHeight:90,rightBtns:[],columns:[{key:"_index",title:"奖励类型",type:"text-view",minWidth:140},{key:"is_calc",title:"是否有奖励",type:"switch",width:140},{key:"is_fixed_calc",title:"奖励类型",type:"radio",minWidth:200,size:"small",optionType:"button",data:[{value:!1,label:"百分比"},{value:!0,label:"固定值"}],showRule:"is_calc=true"},{key:"proportion_value",title:"百分比",type:"percentage",clearable:!1,max:100,minWidth:200,showRule:"is_calc==true&&is_fixed_calc==false"},{key:"fixed_value",title:"固定值",type:"money",placeholder:"请输入固定奖励",minWidth:200,rightText:"元",showRule:"is_calc==true&&is_fixed_calc==true"},{key:"is_level_k",title:"是否受分销等级影响",type:"switch",width:150}],showRule:"fx_mode==fx2&&is_custom==1"}],rules:{regional_reward_multiple:[{required:!0,message:"区域奖励倍数不能为空",trigger:["blur","change"]}]},labelWidth:"120px",beforeAction:function(t){return{_id:t._id,reward_rule:{is_custom:t.is_custom,regional_reward_multiple:t.regional_reward_multiple,share_reward_1:t.tableList[0],share_reward_2:t.tableList[1]}}}}}}},mounted:function(){n=this,n.init()},methods:{init:function(){var t=n,e=t.value;n.$emit("input",e)},onOpen:function(){n=this;var t=n.value.item,e=void 0===t?{}:t,a=e.reward_rule,i=void 0===a?{}:a,r=l.getVuex("$user.mchInfo.fx.mode");n.form1.data=l.pubfn.objectAssign(s,(0,o.default)((0,o.default)({},i),{},{_id:e._id,fx_mode:r})),n.$set(n.form1.data,"tableList",[(0,o.default)((0,o.default)({},n.form1.data.share_reward_1),{},{_index:"一级分销奖励"}),(0,o.default)((0,o.default)({},n.form1.data.share_reward_2),{},{_index:"二级分销奖励"})]),n.keyChange()},keyChange:function(){},onClose:function(){},onFormSuccess:function(t){var e=t.data;l.pubfn.objectAssignForVue(n.value.item,e.info,n),n.value.show=!1,n.$emit("success")}},watch:{},computed:{}};e.default=r},8843:function(t,e,a){"use strict";var i;a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=uni.vk,o={props:{value:{type:Object,default:function(){return{show:!1,mode:"",item:{},url:""}}}},data:function(){return{mobile:{type:"iphone"},page:{title:"商品预览",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"7vh",width:"500px"},form1:{data:{},props:{action:"",columns:[{key:"name",title:"名称",type:"text"}],rules:{},labelWidth:"100px"}}}},mounted:function(){i=this,i.init()},methods:{init:function(){var t=i,e=t.value;i.$emit("input",e)},onOpen:function(){i=this;var t=i.value.item,e=void 0===t?{}:t;i.form1.data=n.pubfn.copyObject(e)},onClose:function(){},close:function(){i.$emit("input",!1)},onFormSuccess:function(){i.value.show=!1,i.$emit("success")}},watch:{},computed:{}};e.default=o},"88b4":function(t,e,a){"use strict";a.r(e);var i=a("8bdd"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},8972:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vk-data-dialog",{attrs:{title:t.page.title,top:t.page.top,width:t.page.width,"close-on-click-modal":!0,mode:"form","show-header":!1},on:{open:function(e){arguments[0]=e=t.$handleEvent(e),t.onOpen.apply(void 0,arguments)},closed:function(e){arguments[0]=e=t.$handleEvent(e),t.onClose.apply(void 0,arguments)}},model:{value:t.value.show,callback:function(e){t.$set(t.value,"show",e)},expression:"value.show"}},[a("v-uni-view",{staticStyle:{padding:"20px"}},[a("el-divider",{attrs:{"content-position":"left"}},[t._v("商品价格")]),t.form1.data.sku_list.length>1?a("v-uni-view",{staticStyle:{display:"flex",height:"30px"}},[a("v-uni-view",{staticClass:"uni-item"},[t._v("统一价格")]),a("v-uni-view",{staticClass:"uni-item"},[a("vk-data-input-money",{staticClass:"sku-input",attrs:{size:"mini",placeholder:"请输入统一价格",clearable:!1},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.allPriceSet.apply(void 0,arguments)}},model:{value:t.unifiedPrice,callback:function(e){t.unifiedPrice=e},expression:"unifiedPrice"}})],1)],1):t._e(),t._l(t.form1.data.sku_list,(function(e,i){return a("v-uni-view",{key:i,staticStyle:{display:"flex",height:"30px","margin-top":"5px"}},[a("v-uni-view",{staticStyle:{"justify-content":"center","align-items":"center",display:"flex",flex:"1"}},[t._v(t._s(e.sku_name))]),a("v-uni-view",{staticStyle:{"justify-content":"center","align-items":"center",display:"flex",flex:"1","margin-left":"4px"}},[a("vk-data-input-money",{staticClass:"sku-input",attrs:{size:"mini",placeholder:"输入价格",clearable:!1},model:{value:e.price,callback:function(a){t.$set(e,"price",a)},expression:"item.price"}})],1)],1)})),a("v-uni-view",{staticStyle:{display:"flex","margin-top":"20px"}},[a("v-uni-view",{staticStyle:{flex:"1","text-align":"center"}},[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.value.show=!1}}},[t._v("取消")])],1),a("v-uni-view",{staticStyle:{flex:"1","text-align":"center"}},[a("el-button",{attrs:{size:"mini",type:"primary",loading:t.loadingSave},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submitForm.apply(void 0,arguments)}}},[t._v("保存")])],1)],1),a("i",{staticClass:"el-icon-edit",staticStyle:{transform:"scale(1.1)",color:"#409eff","font-weight":"bold",float:"right","line-height":"20px",cursor:"pointer","margin-right":"20px"},attrs:{slot:"reference",size:"large"},slot:"reference"})],2)],1)},n=[]},"8bdd":function(t,e,a){"use strict";var i;a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("fd3c"),a("aa9c"),a("473f"),a("bf0f");var n=uni.vk,o={},l={props:{value:{type:Object,default:function(){return{show:!1,mode:"",item:""}}}},data:function(){return{loading:!1,page:{title:"设置会员价",submitText:"设置"},titleArr:[],form1:{name:"",is_fixed_calc:!1,spec_list:[]},formData1:{action:"admin/sys.goods.updateVipMoney",columns:[{key:"name",title:"商品名称:",type:"text"},{key:"is_fixed_calc",title:"优惠方式:",type:"radio",data:[{value:!1,label:"打折"},{value:!0,label:"指定价格"}]},{key:"spec_list",title:"",type:"table",minWidth:200,maxHeight:600}],rules:{}}}},mounted:function(){i=this,i.init()},methods:{init:function(){o["form1"]=n.pubfn.copyObject(i.form1)},onOpen:function(){i=this;var t=i,e=t.value,a=t.form1,n=t.vk,o=n.pubfn.copyObject(e.item);a.spec_list=o.spec_list,a.name=o.name,a.sku_list=o.sku_list,n.pubfn.isNotNull(o.sku_list[0].vip_price_rules)&&(a.is_fixed_calc=o.sku_list[0].vip_price_rules[0].is_fixed_calc),i.initVipPriceRulesList()},initVipPriceRulesList:function(){var t=i.form1.sku_list;i.loading=!0,n.callFunction({url:"client/pub.getMchInfo",data:{},success:function(e){var a=n.pubfn.getData(e,"mchInfo.vip_level_rule");a.map((function(e,a){var i=!1,o=e.lv;t.map((function(t,e){if(n.pubfn.isNotNull(t.vip_price_rules)){var a=n.pubfn.getListItem(t.vip_price_rules,"_id",o);n.pubfn.isNull(a)&&(i=!0)}else t.vip_price_rules=[],i=!0;i&&t.vip_price_rules.push({_id:o,is_fixed_calc:!0,fixed_value:"",proportion_value:""})}))}));var o=[];i.form1.spec_list.map((function(t,e){o.push(t.name)})),o.push("商城价格"),a.map((function(t,e){o.push(t.name)})),i.titleArr=o,i.loading=!1}})},onClose:function(){i.resetForm()},pageBack:function(){var t=i,e=t.value;e.show=!1,i.$emit("input",e)},resetForm:function(){n.pubfn.resetForm(o,i)},submitForm:function(){var t=!1,e=i.form1,a=e.sku_list,n=e.is_fixed_calc;if(i.form1.rules_list=a.reduce((function(e,a,i){return a.vip_price_rules.map((function(e,a){0===e.proportion_value&&0===e.fixed_value&&(t=!0),e.is_fixed_calc=n})),e.push({_id:a._id,vip_price_rules:a.vip_price_rules}),e}),[]),t)return this.$message.error("会员价不能为0折"),!1;i.$refs.form1.submitForm()},onFormSuccess:function(){i.$emit("success"),i.pageBack()}},watch:{},filters:{is_priceFilter:function(t){return"number"===typeof t?priceFilter(t):t}},computed:{}};e.default=l},"8ff0":function(t,e,a){var i=a("f214");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("967d").default;n("1ea8f4ee",i,!0,{sourceMap:!1,shadowMode:!1})},"924c":function(t,e,a){"use strict";a.r(e);var i=a("85ff"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},"976f":function(t,e,a){"use strict";var i;a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=uni.vk,o={props:{value:{type:Object,default:function(){return{show:!1,mode:"",item:{}}}}},data:function(){var t=this;return{page:{title:"商品导入",submitText:"导入",cancelText:"关闭",showCancel:!0,top:"7vh",width:"800px"},form1:{data:{fileName:"",base64:"",imageMode:!1},props:{action:"admin/sys.goods.importGoods",columns:[{key:"",title:"商品导入（用excel表格快速导入本地商品）",type:"bar-title"},{key:"fileName",title:"商品excel文件",type:"file",limit:1,accept:".xls,.xlsx",buttonText:"点击上传商品excel文件",onSuccess:function(t){i.form1.data.fileName=t.file.name,i.form1.data.base64=t.base64},httpRequest:function(t){t.action;var e=t.file,a=(t.filename,t.data,t.headers,t.onProgress,t.onSuccess);t.onError;n.pubfn.fileToBase64({file:e,success:function(t){a({file:e,base64:t})}})},tips:[{text:"你需要使用指定的模板文件才能正确导入！"},{text:"下载商品导入模板",click:function(){t.downFile("static/excel/goods.xlsx","商品导入模板.xlsx")}}]},{key:"tips",title:"",type:"text"}],rules:{fileName:[{required:!0,message:"请上传商品excel文件",trigger:["blur","change"]}],cloneImage:[{required:!0,message:"请选择图片储存方式",trigger:["blur","change"]}]},labelWidth:"120px"}}}},mounted:function(){i=this,i.init()},methods:{init:function(){var t=i,e=t.value;i.$emit("input",e)},onOpen:function(){i=this;i.value.item},onClose:function(){i.form1.data.fileName="",i.form1.data.base64=""},onFormSuccess:function(){i.value.show=!1,i.$emit("success")},downFile:function(t,e){var a=window.location.pathname,i=n.h5.getRootPath()+a;"/"!==i[i.length-1]&&(i+="/");var o=i+t,l=document.createElement("a");l.href=o,l.download=e,document.body.appendChild(l),l.click(),document.body.removeChild(l)}},watch:{},computed:{}};e.default=o},a143:function(t,e,a){"use strict";a.r(e);var i=a("976f"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},a7a1:function(t,e,a){"use strict";a.r(e);var i=a("8972"),n=a("723d");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("1dcc");var l=a("828b"),s=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"475b9fbb",null,!1,i["a"],void 0);e["default"]=s.exports},b891:function(t,e,a){"use strict";a.r(e);var i=a("4f6b"),n=a("88b4");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("2994");var l=a("828b"),s=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"4bc3da54",null,!1,i["a"],void 0);e["default"]=s.exports},bc3a:function(t,e,a){"use strict";var i=a("8ff0"),n=a.n(i);n.a},c0a4:function(t,e,a){"use strict";a.r(e);var i=a("df9e"),n=a("6981");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("c3ea");var l=a("828b"),s=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"c89a061a",null,!1,i["a"],void 0);e["default"]=s.exports},c2f7:function(t,e,a){"use strict";a.r(e);var i=a("d4c0"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},c314:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vk-data-drawer",{attrs:{title:t.page.title,top:t.page.top,width:t.page.width,"close-on-click-modal":!0,mode:"form"},on:{open:function(e){arguments[0]=e=t.$handleEvent(e),t.onOpen.apply(void 0,arguments)},closed:function(e){arguments[0]=e=t.$handleEvent(e),t.onClose.apply(void 0,arguments)}},model:{value:t.value.show,callback:function(e){t.$set(t.value,"show",e)},expression:"value.show"}},[a("vk-data-form",{ref:"form1",attrs:{"form-type":t.value.mode,rules:t.form1.props.rules,action:t.form1.props.action,columns:t.form1.props.columns,loading:t.form1.props.loading,labelWidth:t.form1.props.labelWidth,"before-action":t.form1.props.beforeAction,"show-cancel":t.page.showCancel,"cancel-text":t.page.cancelText,"submit-text":t.page.submitText,"max-height":"1000px"},on:{"update:loading":function(e){arguments[0]=e=t.$handleEvent(e),t.$set(t.form1.props,"loading",e)},success:function(e){arguments[0]=e=t.$handleEvent(e),t.onFormSuccess.apply(void 0,arguments)}},model:{value:t.form1.data,callback:function(e){t.$set(t.form1,"data",e)},expression:"form1.data"}})],1)},n=[]},c3ea:function(t,e,a){"use strict";var i=a("080b"),n=a.n(i);n.a},ce6d:function(t,e,a){var i=a("61e0");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("967d").default;n("1440a1ac",i,!0,{sourceMap:!1,shadowMode:!1})},d4c0:function(t,e,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(a("9b1b")),o=i(a("39d8"));a("fd3c"),a("aa9c"),a("64aa"),a("c223"),a("5ef2"),a("3efd"),a("5c47"),a("af8f"),a("e966");var l,s=i(a("b891")),r=i(a("c0a4")),u=i(a("a7a1")),c=i(a("017b")),d=i(a("1eac")),f=i(a("3b9b")),p=i(a("3c68")),m=uni.vk,v={components:{vipMoney:s.default,updateStock:r.default,updatePrice:u.default,previewGoods:c.default,updateGoodsReward:d.default,updateGoodsCategory:f.default,importGoods:p.default},data:function(){var t=this;return{loading:!1,statusCountGroup:{},category:{list:[],props:{children:"children",label:"name"},countObj:{},loading:!1},data:{},table1:{action:"admin/sys.goods.getList",columns:[{key:"sort",title:"排序",type:"number",width:80,defaultValue:"0",sortable:"custom"},{key:"goods_thumb",title:"商品图",type:"avatar",imageWidth:40,shape:"square"},{key:"name",title:"商品名称",type:"text",width:160,align:"left",maxlength:20,showWordLimit:!0,buttonsPosition:"left",buttons:[{title:"修改",type:"text",mode:"update",show:["row"],showRule:function(t){return 1!=t.key2},click:function(t){l.updateGoodsBaseInfo({data:t.formData,success:function(e){t.success({msg:"修改成功"})}})}}]},{key:"goods_desc",title:"商品描述",type:"text",width:160,defaultValue:"暂无",show:["detail"]},{key:"categoryList",title:"所属分类",type:"text",width:140,defaultValue:"暂无",formatter:function(t,e,a,i){var n="";return t.map((function(t,e){e>0&&(n+="、"),n+=t.name})),n}},{key:"sku_list",title:"价格区间",type:"text",width:200,defaultValue:"暂无",formatter:function(t,e,a,i){var n=[];t.map((function(t,e){n.push(Number(t.price))}));var o=Math.max.apply(Math,n),l=Math.min.apply(Math,n);return o!=l?m.pubfn.priceFilter(l)+" - "+m.pubfn.priceFilter(o):m.pubfn.priceFilter(l)}},{key:"stock",title:"商品库存",type:"number",width:130,show:["row"]},{key:"type",title:"商品类别",type:"radio",width:90,defaultValue:0,data:[{value:0,label:"实物商品"},{value:1,label:"电子卡券"}]},{key:"is_on_sale",title:"是否上架",type:"switch",width:80,watch:function(t){var e=t.value,a=t.row,i=t.change;m.callFunction({url:"admin/sys.goods.updateIsOnSale",title:e?"上架中...":"下架中...",data:{ids:[a._id],is_on_sale:e},success:function(t){i(e)}})}},{key:"reward_rule",title:"分销奖励规则",type:"text",width:120,show:["row"]},{key:"keywords",title:"商品关键字",type:"text",width:100,defaultValue:"暂无"},{key:"view_count",title:"累计浏览量",type:"number",width:140,defaultValue:0,sortable:"custom"},{key:"total_sell_count",title:"显示总销量",type:"number",width:140,defaultValue:0,sortable:"custom"},{key:"initial_sell_count",title:"初始总销量",type:"number",width:140,defaultValue:0,sortable:"custom"},{key:"real_sell_count",title:"实际总销量",type:"number",width:140,defaultValue:0,sortable:"custom"},{key:"comment_count",title:"累计评价数",type:"number",width:140,defaultValue:0,sortable:"custom"},{key:"on_sale_time",title:"上架时间",type:"time",width:160},{key:"is_best",title:"是否精品",type:"switch",activeValue:!0,inactiveValue:!1,width:80,watch:function(t){var e=t.value,a=t.row,i=t.column,n=t.change;l.updateGoodsBaseInfo({data:(0,o.default)({_id:a._id},i.key,e),success:function(t){n(e)}})}},{key:"is_new",title:"是否新品",type:"switch",activeValue:!0,inactiveValue:!1,width:80,watch:function(t){var e=t.value,a=t.row,i=t.column,n=t.change;l.updateGoodsBaseInfo({data:(0,o.default)({_id:a._id},i.key,e),success:function(t){n(e)}})}},{key:"is_hot",title:"是否热销",type:"switch",activeValue:!0,inactiveValue:!1,width:80,watch:function(t){var e=t.value,a=t.row,i=t.column,n=t.change;l.updateGoodsBaseInfo({data:(0,o.default)({_id:a._id},i.key,e),success:function(t){n(e)}})}},{key:"disable_vip",title:"是否禁用会员价",type:"switch",activeValue:!0,inactiveValue:!1,width:130,activeColor:"#ff4949",inactiveColor:"#13ce66",activeText:"禁",inactiveText:"可",watch:function(t){var e=t.value,a=t.row,i=t.column,n=t.change;l.updateGoodsBaseInfo({data:(0,o.default)({_id:a._id},i.key,e),success:function(t){n(e)}})}},{key:"disable_coupon",title:"是否禁用优惠券",type:"switch",activeValue:!0,inactiveValue:!1,width:130,activeColor:"#ff4949",inactiveColor:"#13ce66",activeText:"禁",inactiveText:"可",watch:function(t){var e=t.value,a=t.row,i=t.column,n=t.change;l.updateGoodsBaseInfo({data:(0,o.default)({_id:a._id},i.key,e),success:function(t){n(e)}})}},{key:"seller_note",title:"商家备注,仅商家可见",type:"text",width:160,defaultValue:"暂无"},{key:"_add_time",title:"创建时间",type:"time",width:180},{key:"update_time",title:"修改时间",type:"dateDiff",width:160,defaultValue:"无"},{key:"_id",title:"商品ID",type:"text",width:210},{key:"goods_banner_imgs",title:"商品轮播图",type:"image",width:200,show:["detail"]},{key:"goods_detail_mode",title:"展示方式",type:"radio",show:["detail"],data:[{value:0,label:"简易模式（纯图片）"},{value:1,label:"富文本模式（图片+文字）"}]},{key:"goods_detail_imgs",title:"简易模式图片",type:"image",width:200,show:["detail"]},{key:"goods_detail_body",title:"富文本模式详情",type:"html",width:360,show:["detail"]}],multipleSelection:[],selectItem:"",rightBtnsMore:[{title:"预览",onClick:function(e){var a=m.getVuex("$user.mchInfo.h5")||{},i=a.domain,n=a.path;if(i){var o;o=n?"".concat(i,"/").concat(n):i;var l="/pages/goods/goods-detail?_id=".concat(e._id),s=o+l;m.pubfn.openForm("previewGoods",{url:s})}else t.$confirm("请先前往平台管理-h5，设置服务域名","提示",{confirmButtonText:"立即前往",cancelButtonText:"取消",type:"warning"}).then((function(){m.navigateTo("/pages/app-platform/h5")})).catch((function(){}))}},{title:"查看评价",onClick:function(t){m.navigateTo("./comment/list?_id=".concat(t._id))}},{title:"查看订单",onClick:function(t){m.navigateTo("/pages/order/list?goods_id=".concat(t._id))}},{title:"独立会员价",onClick:function(t){m.pubfn.openForm("vipMoney",{item:t})}},{title:"复制创建",onClick:function(t){l.copyNewGoods(t)}},{title:"删除",onClick:function(t){l.deleteGoods(t._id)},show:function(t){return[0,1,2].indexOf(t.status)>-1}}]},queryForm1:{formData:{status:0,name:"",_add_time:[],category_ids:""},columns:[{key:"name",type:"text",title:"",placeholder:"请输入商品名称",width:220,mode:"%%"},{key:"_add_time",type:"datetimerange",title:"添加时间",width:320,mode:"[]"},{key:"category_ids",type:"text",title:"分类",width:320,mode:"in",show:!1}]},skuDetailDialog:{show:!1,columns:[{key:"spec_list",title:"规格组列表",type:"table",width:160,defaultValue:"暂无",show:["detail"],columns:[{key:"name",title:"规格名",type:"tag",width:100,size:"medium",formatter:function(t,e,a,i){return{val:t,tagType:""}}},{key:"list",title:"规格值",type:"html",minWidth:100,align:"left",formatter:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e="",a=0;a<t.length;a++)e+='<span class="el-tag el-tag--medium el-tag--plain">'.concat(t[a].name,"</span>"),a<t.length-1&&(e+=" ");return e}}]},{key:"sku_list",title:"sku列表",type:"table",width:160,show:["detail"],columns:[{key:"image",title:"商品图片",type:"avatar",width:100},{key:"sku_name",title:"SKU名称",type:"text",minWidth:100},{key:"price",title:"价格",type:"money",width:100},{key:"market_price",title:"市场价",type:"money",width:100,defaultValue:"未设置"},{key:"stock",title:"库存",type:"number",width:100,defaultValue:0},{key:"weight",title:"重量",type:"number",width:100,defaultValue:0},{key:"real_sell_count",title:"销量",type:"number",width:100,defaultValue:0}]}]},formDatas:{}}},onLoad:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l=this,m=l.vk,l.options=t,l.init(t)},onReady:function(){},onShow:function(){},onHide:function(){},methods:{init:function(t){t.msg&&setTimeout((function(){l.$notify({message:"操作成功!",type:"success"})}),100),l.getCategory(),l.getStatusCountGroup()},getStatusCountGroup:function(){m.callFunction({url:"admin/sys.goods.getStatusCountGroup",data:{},success:function(t){l.statusCountGroup=t.group}})},getCategory:function(){m.callFunction({url:"admin/sys.category.kh_getList",loading:{name:"category.loading",that:l},data:{formData:{type:"goods",enable:!0},columns:[{key:"type",mode:"%%"},{key:"enable",mode:"="}]},success:function(t){t.rows.unshift({_id:"",name:"全部"}),l.category.list=t.rows}})},pageTo:function(t){m.navigateTo(t)},search:function(t){l.$refs.table1.query(t),l.getStatusCountGroup()},refresh:function(){l.$refs.table1.refresh(),l.getStatusCountGroup()},getCurrentRow:function(t){return l.$refs.table1.getCurrentRow(t)},currentChange:function(t){l.table1.selectItem=t},selectionChange:function(t){l.table1.multipleSelection=t},addBtn:function(){m.navigateTo({url:"./edit?mode=add",events:{add:function(t){l.refresh()}}})},updateBtn:function(t){t.item;var e=t.row;m.navigateTo({url:"./edit?mode=update&_id=".concat(e._id),events:{update:function(t){m.pubfn.objectAssign(e,t)}}})},deleteBtn:function(t){var e=t.item,a=t.deleteFn;a({action:"admin/sys.goods.delete",data:{_id:e._id}})},batchBtn:function(t){switch(t){case 0:l.updateCategory();break;case 1:l.updateIsOnSale(!0);break;case 2:l.updateIsOnSale(!1);break;case 3:l.deleteGoods();break;case 4:l.recoveryGoods();break;default:break}},customRightBtns:function(t,e){"SKU"===e.title&&(l.skuDetailDialog.show=!0)},copyNewGoods:function(t){l.$message({message:"复制成功,将为您打开添加页面!",type:"success",duration:600}),setTimeout((function(){m.navigateTo({url:"./edit?mode=add&_id=".concat(t._id),events:{add:function(t){l.refresh()}}})}),600)},updateCategory:function(){var t=[];l.table1.multipleSelection.map((function(e,a){t.push(e._id)})),m.pubfn.openForm("updateGoodsCategory",{goods_ids:t})},deleteGoods:function(t){var e={mode:2===l.queryForm1.formData.status?2:1};m.pubfn.isNull(t)&&(t=m.pubfn.arrayObjectGetArray(l.table1.multipleSelection,"_id")),m.pubfn.isArray(t)?e["ids"]=t:e["ids"]=[t],m.callFunction({url:"admin/sys.goods.delete",title:"请求中...",data:e,success:function(t){l.refresh()}})},recoveryGoods:function(){var t=m.pubfn.arrayObjectGetArray(l.table1.multipleSelection,"_id");m.callFunction({url:"admin/sys.goods.recovery",title:"请求中...",data:{ids:t},success:function(t){l.refresh()}})},updateIsOnSale:function(t){var e=m.pubfn.arrayObjectGetArray(l.table1.multipleSelection,"_id");m.callFunction({url:"admin/sys.goods.updateIsOnSale",title:"请求中...",data:{ids:e,is_on_sale:t},success:function(t){l.refresh()}})},categoryChange:function(t){l.queryForm1.formData.category_ids=t._id,l.search()},sortChange:function(t,e){m.callFunction({url:"admin/sys.goods.updateGoodsSort",data:{_id:e._id,sort:Number(t)},success:function(t){}})},updateGoodsBaseInfo:function(t){m.callFunction((0,n.default)({url:"admin/sys.goods.updateGoodsBaseInfo",title:"请求中..."},t))},stockFn:function(t){var e=0;return t.map((function(t,a){e+=parseInt(t.stock)})),parseInt(e)},priceRegionFn:function(t){var e=[];t.map((function(t,a){e.push(Number(t.price))}));var a=Math.max.apply(Math,e),i=Math.min.apply(Math,e);return a!=i?m.pubfn.priceFilter(i)+" - "+m.pubfn.priceFilter(a):m.pubfn.priceFilter(i)},exportGoods:function(){var t=[{value:!0,label:"是"},{value:!1,label:"否"}],e=function(t,e,a,i){var n="";return t.map((function(e,a){n+="".concat(e),t.length-1!=a&&(n+=",")})),n};this.$refs.table1.exportExcel({fileName:"商品数据",title:"正在导出数据...",pageIndex:1,pageSize:-1,columns:[{key:"sort",title:"排序",type:"number"},{key:"is_on_sale",title:"销售状态",type:"radio",data:[{value:!0,label:"上架"},{value:!1,label:"下架"}]},{key:"type",title:"商品类型",type:"radio",data:[{value:0,label:"实物"},{value:1,label:"虚拟"}]},{key:"name",title:"商品名称",type:"text"},{key:"categoryList",title:"所属分类",type:"text",formatter:function(t,e,a,i){var n="";return t.map((function(t,e){e>0&&(n+=","),n+=t.name})),n}},{key:"goods_desc",title:"商品描述",type:"text"},{key:"goods_thumb",title:"商品图片链接",type:"text"},{key:"goods_banner_imgs",title:"商品轮播图链接",type:"text",formatter:e},{key:"goods_detail_imgs",title:"商品详情页图片链接",type:"text",formatter:e},{key:"goods_services",title:"服务标签",type:"text",formatter:e},{key:"is_free_delivery",title:"是否包邮",type:"radio",data:t,defaultValue:"否"},{key:"freight_id",title:"运费id",type:"text"},{key:"spec_list",title:"规格信息",type:"text",formatter:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e="";return t.map((function(a,i){e+="".concat(a.name,":"),a.list.map((function(t,i){e+="".concat(t.name),a.list.length-1!==i&&(e+=",")})),t.length-1!==i&&(e+=";")})),e}},{key:"sku_list",title:"具体规格",type:"text",formatter:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e="";return t.map((function(a,i){var n="";a.sku_name_arr.map((function(t,e){n+=t,a.sku_name_arr.length-1!==e&&(n+=",")}));var o=m.pubfn.toDecimal(a.price/100,2),l=0;a.market_price&&(l=m.pubfn.toDecimal(a.market_price/100,2)),e+="".concat(n,"::").concat(o,",").concat(l,",").concat(a.stock,",").concat(a.weight,",").concat(a.image),t.length-1!==i&&(e+=";")})),e}},{key:"is_new",title:"是否新品",type:"radio",data:t,defaultValue:"否"},{key:"is_best",title:"是否精品",type:"radio",data:t,defaultValue:"否"},{key:"is_hot",title:"是否热销",type:"radio",data:t,defaultValue:"否"},{key:"disable_vip",title:"是否禁用会员价",type:"radio",data:t,defaultValue:"否"},{key:"disable_coupon",title:"是否禁用优惠券",type:"radio",data:t,defaultValue:"否"},{key:"initial_sell_count",title:"商品初始销量",type:"text"},{key:"exp_time_mode",title:"虚拟商品有效期模式",type:"number",formatter:function(t,e,a,i){return 0==e.type?"":t}},{key:"exp_time_range",title:"虚拟商品有效期",type:"text",formatter:function(t,e,a,i){return 0==e.type?"":0===e.exp_time_mode?"长期有效":1===e.exp_time_mode?"".concat(e.exp_time_range[0],"-").concat(e.exp_time_range[1]):2===e.exp_time_mode?"".concat(e.exp_time_rule[0],"-").concat(e.exp_time_rule[1]):void 0}}]})},importGoods:function(){m.pubfn.openForm("importGoods",{item:{}})}},watch:{},computed:{}};e.default=v},d840:function(t,e,a){"use strict";var i;a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("fd3c");var n=uni.vk,o={props:{value:{type:Object,default:function(){return{show:!1,mode:"",item:{}}}}},data:function(){return{unifiedPrice:"",loadingSave:!1,page:{title:"商品库存",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"14vh",width:"400px"},form1:{data:{sku_list:[]},props:{}}}},mounted:function(){i=this,i.init()},methods:{init:function(){var t=i,e=t.value;i.$emit("input",e)},onOpen:function(){i=this;var t=i.value.item,e=void 0===t?{}:t;i.form1.data=n.pubfn.copyObject(e)},onClose:function(){},onFormSuccess:function(){i.value.item.sku_list=n.pubfn.copyObject(i.form1.data.sku_list),i.value.show=!1,i.$emit("success")},submitForm:function(){n.callFunction({url:"admin/sys.goods.updateGoodsSku",loading:{that:i,name:"loadingSave"},data:{_id:i.form1.data._id,sku_list:i.form1.data.sku_list},success:function(t){i.$message({message:"操作成功!",type:"success"}),i.onFormSuccess()}})},allPriceSet:function(){n.pubfn.isNotNull(i.unifiedPrice)&&i.form1.data.sku_list.map((function(t,e){t.price=i.unifiedPrice}))}},watch:{},computed:{}};e.default=o},db7c:function(t,e,a){var i=a("48c6");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("967d").default;n("70e73e85",i,!0,{sourceMap:!1,shadowMode:!1})},df9e:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vk-data-dialog",{attrs:{title:t.page.title,top:t.page.top,width:t.page.width,"close-on-click-modal":!0,mode:"form","show-header":!1},on:{open:function(e){arguments[0]=e=t.$handleEvent(e),t.onOpen.apply(void 0,arguments)},closed:function(e){arguments[0]=e=t.$handleEvent(e),t.onClose.apply(void 0,arguments)}},model:{value:t.value.show,callback:function(e){t.$set(t.value,"show",e)},expression:"value.show"}},[a("v-uni-view",{staticStyle:{padding:"20px"}},[a("el-divider",{attrs:{"content-position":"left"}},[t._v("商品库存")]),t.form1.data.sku_list.length>1?a("v-uni-view",{staticStyle:{display:"flex",height:"30px"}},[a("v-uni-view",{staticClass:"uni-item"},[t._v("统一库存")]),a("v-uni-view",{staticClass:"uni-item"},[a("vk-data-input-number",{staticClass:"sku-input",attrs:{size:"mini",precision:0,placeholder:"请输入统一库存",clearable:!1},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.allStockSet.apply(void 0,arguments)}},model:{value:t.unifiedStock,callback:function(e){t.unifiedStock=e},expression:"unifiedStock"}})],1)],1):t._e(),t._l(t.form1.data.sku_list,(function(e,i){return a("v-uni-view",{key:i,staticStyle:{display:"flex",height:"30px","margin-top":"5px"}},[a("v-uni-view",{staticStyle:{"justify-content":"center","align-items":"center",display:"flex",flex:"1"}},[t._v(t._s(e.sku_name))]),a("v-uni-view",{staticStyle:{"justify-content":"center","align-items":"center",display:"flex",flex:"1"}},[a("vk-data-input-number",{staticClass:"sku-input",attrs:{size:"mini",precision:0,placeholder:"输入库存",clearable:!1},model:{value:e.stock,callback:function(a){t.$set(e,"stock",a)},expression:"item.stock"}})],1)],1)})),t.form1.data.sku_list.length>1?a("v-uni-view",{staticStyle:{display:"flex",height:"30px","margin-top":"5px"}},[a("v-uni-view",{staticStyle:{"justify-content":"center","align-items":"center",display:"flex",flex:"1"}},[t._v("合计")]),a("v-uni-view",{staticStyle:{"justify-content":"flex-start","align-items":"center",display:"flex",flex:"1","font-size":"12px"}},[t._v(t._s(t.stockCom))])],1):t._e(),a("v-uni-view",{staticStyle:{display:"flex","margin-top":"20px"}},[a("v-uni-view",{staticStyle:{flex:"1","text-align":"center"}},[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.value.show=!1}}},[t._v("取消")])],1),a("v-uni-view",{staticStyle:{flex:"1","text-align":"center"}},[a("el-button",{attrs:{size:"mini",type:"primary",loading:t.loadingSave},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submitForm.apply(void 0,arguments)}}},[t._v("保存")])],1)],1),a("i",{staticClass:"el-icon-edit",staticStyle:{transform:"scale(1.1)",color:"#409eff","font-weight":"bold",float:"right","line-height":"20px",cursor:"pointer","margin-right":"20px"},attrs:{slot:"reference",size:"large"},slot:"reference"})],2)],1)},n=[]},e016:function(t,e,a){"use strict";var i=a("79c8"),n=a.n(i);n.a},e3f1:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"page-body"},[a("vk-data-table-query",{attrs:{columns:t.queryForm1.columns,size:"mini"},on:{search:function(e){arguments[0]=e=t.$handleEvent(e),t.search.apply(void 0,arguments)}},model:{value:t.queryForm1.formData,callback:function(e){t.$set(t.queryForm1,"formData",e)},expression:"queryForm1.formData"}}),a("v-uni-view",{staticClass:"btns-box"},[a("el-row",[a("el-radio-group",{attrs:{size:"mini"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.search.apply(void 0,arguments)}},model:{value:t.queryForm1.formData.status,callback:function(e){t.$set(t.queryForm1.formData,"status",e)},expression:"queryForm1.formData.status"}},[a("el-badge",{staticClass:"group-badge",attrs:{value:t.statusCountGroup[0]>0?t.statusCountGroup[0]:"",max:999}},[a("el-radio-button",{attrs:{label:0}},[t._v("上架")])],1),a("el-badge",{staticClass:"group-badge",attrs:{value:t.statusCountGroup[1]>0?t.statusCountGroup[1]:"",max:999}},[a("el-radio-button",{attrs:{label:1}},[t._v("下架")])],1),a("el-radio-button",{attrs:{label:2}},[t._v("回收站")]),a("el-badge",{staticClass:"group-badge",attrs:{value:t.statusCountGroup[3]>0?t.statusCountGroup[3]:"",max:999}},[a("el-radio-button",{attrs:{label:3}},[t._v("已售罄")])],1)],1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success",size:"mini",icon:"el-icon-circle-plus-outline"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.addBtn.apply(void 0,arguments)}}},[t._v("添加")]),t.table1.multipleSelection?a("el-dropdown",{attrs:{"split-button":!1,trigger:"click"},on:{command:function(e){arguments[0]=e=t.$handleEvent(e),t.batchBtn.apply(void 0,arguments)}}},[a("el-button",{staticStyle:{"margin-left":"20rpx"},attrs:{type:"danger",size:"mini",disabled:0===t.table1.multipleSelection.length}},[t._v("批量操作"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:0}},[t._v("修改分类")]),a("el-dropdown-item",{attrs:{command:1}},[t._v("批量上架")]),a("el-dropdown-item",{attrs:{command:2}},[t._v("批量下架")]),a("el-dropdown-item",{attrs:{command:3}},[t._v("批量删除")]),a("el-dropdown-item",{attrs:{command:4}},[t._v("批量恢复")])],1)],1):t._e(),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.exportGoods.apply(void 0,arguments)}}},[t._v("导出商品")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.importGoods.apply(void 0,arguments)}}},[t._v("导入商品")])],1)],1),a("el-container",[a("el-aside",{staticStyle:{"margin-top":"10px"},attrs:{width:"125px"}},[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:t.category.loading,expression:"category.loading"}],attrs:{data:t.category.list,props:t.category.props,"highlight-current":!0},on:{"node-click":function(e){arguments[0]=e=t.$handleEvent(e),t.categoryChange.apply(void 0,arguments)}}})],1),a("el-main",{staticStyle:{padding:"0"}},[a("vk-data-table",{ref:"table1",attrs:{action:t.table1.action,columns:t.table1.columns,"query-form-param":t.queryForm1,"right-btns":["detail_auto","update","more"],"custom-right-btns":[{title:"SKU",icon:"el-icon-shopping-cart-2",type:""}],"right-btns-more":t.table1.rightBtnsMore,selection:!0,"row-no":!1,pagination:!0,size:"mini"},on:{update:function(e){arguments[0]=e=t.$handleEvent(e),t.updateBtn.apply(void 0,arguments)},delete:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteBtn.apply(void 0,arguments)},"current-change":function(e){arguments[0]=e=t.$handleEvent(e),t.currentChange.apply(void 0,arguments)},"selection-change":function(e){arguments[0]=e=t.$handleEvent(e),t.selectionChange.apply(void 0,arguments)},"custom-right-btns":function(e){arguments[0]=e=t.$handleEvent(e),t.customRightBtns.apply(void 0,arguments)}},scopedSlots:t._u([{key:"sort",fn:function(e){var i=e.row;e.column,e.index;return[a("el-input",{attrs:{size:"mini"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.sortChange(e,i)}},model:{value:i.sort,callback:function(e){t.$set(i,"sort",e)},expression:"row.sort"}})]}},{key:"stock",fn:function(e){var i=e.row;e.column,e.index;return[a("v-uni-text",[t._v(t._s(t.stockFn(i.sku_list)))]),a("vk-data-icon",{staticStyle:{"margin-left":"10px"},attrs:{name:"el-icon-edit",color:"#409eff",bold:!0,pointer:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.vk.pubfn.openForm("updateStock",{item:i})}}})]}},{key:"sku_list",fn:function(e){var i=e.row;e.column,e.index;return[a("v-uni-text",[t._v(t._s(t.priceRegionFn(i.sku_list)))]),a("vk-data-icon",{staticStyle:{"margin-left":"10px"},attrs:{name:"el-icon-edit",color:"#409eff",bold:!0,pointer:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.vk.pubfn.openForm("updatePrice",{item:i})}}})]}},{key:"reward_rule",fn:function(e){var i=e.row;e.column,e.index;return[a("v-uni-view",["none"==t.vk.getVuex("$user.mchInfo.fx.mode")?a("v-uni-text",[t._v("未开启分销")]):1==t.$fn.getData(i,"reward_rule.is_custom")?a("v-uni-text",{staticStyle:{color:"#1aad19"}},[t._v("独立规则")]):-1==t.$fn.getData(i,"reward_rule.is_custom")?a("v-uni-text",{staticStyle:{color:"#f56c6c"}},[t._v("无奖励")]):a("v-uni-text",[t._v("默认规则")]),"none"!==t.vk.getVuex("$user.mchInfo.fx.mode")?a("el-button",{staticStyle:{"margin-left":"6px"},attrs:{type:"text",size:"mini"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.vk.pubfn.openForm("updateGoodsReward",{item:i})}}},[t._v("设置")]):t._e()],1)]}}])})],1)],1),a("vk-data-dialog",{attrs:{width:"1000px",top:"14vh",center:!0,"close-on-click-modal":!0},model:{value:t.skuDetailDialog.show,callback:function(e){t.$set(t.skuDetailDialog,"show",e)},expression:"skuDetailDialog.show"}},[a("vk-data-detail-table",{attrs:{data:t.table1.selectItem,columns:t.skuDetailDialog.columns}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.skuDetailDialog.show=!1}}},[t._v("关 闭")])],1)],1),a("vipMoney",{on:{success:function(e){arguments[0]=e=t.$handleEvent(e),t.refresh.apply(void 0,arguments)}},model:{value:t.formDatas.vipMoney,callback:function(e){t.$set(t.formDatas,"vipMoney",e)},expression:"formDatas.vipMoney"}}),a("updateStock",{model:{value:t.formDatas.updateStock,callback:function(e){t.$set(t.formDatas,"updateStock",e)},expression:"formDatas.updateStock"}}),a("updatePrice",{model:{value:t.formDatas.updatePrice,callback:function(e){t.$set(t.formDatas,"updatePrice",e)},expression:"formDatas.updatePrice"}}),a("previewGoods",{model:{value:t.formDatas.previewGoods,callback:function(e){t.$set(t.formDatas,"previewGoods",e)},expression:"formDatas.previewGoods"}}),a("updateGoodsReward",{model:{value:t.formDatas.updateGoodsReward,callback:function(e){t.$set(t.formDatas,"updateGoodsReward",e)},expression:"formDatas.updateGoodsReward"}}),a("updateGoodsCategory",{on:{success:function(e){arguments[0]=e=t.$handleEvent(e),t.refresh.apply(void 0,arguments)}},model:{value:t.formDatas.updateGoodsCategory,callback:function(e){t.$set(t.formDatas,"updateGoodsCategory",e)},expression:"formDatas.updateGoodsCategory"}}),a("importGoods",{on:{success:function(e){arguments[0]=e=t.$handleEvent(e),t.refresh.apply(void 0,arguments)}},model:{value:t.formDatas.importGoods,callback:function(e){t.$set(t.formDatas,"importGoods",e)},expression:"formDatas.importGoods"}})],1)},n=[]},e520:function(t,e,a){"use strict";a.r(e);var i=a("e3f1"),n=a("c2f7");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("e016");var l=a("828b"),s=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"60694df3",null,!1,i["a"],void 0);e["default"]=s.exports},edde:function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".uni-item[data-v-c89a061a]{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1;flex:1;background-color:#f8f8f8}",""]),t.exports=e},f214:function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".preview-drawer-btn[data-v-03b27407]{width:100%;bottom:10px;right:20px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:absolute}.preview-drawer-btn .table-btn.active[data-v-03b27407],\n.preview-drawer-btn .table-btn[data-v-03b27407]:hover{color:#409eff!important;background-color:#ecf5ff!important;border-color:#ecf5ff!important}",""]),t.exports=e},f251:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vk-data-dialog",{attrs:{title:t.page.title,top:t.page.top,width:t.page.width,"close-on-click-modal":!0,"destroy-on-close":!0,mode:"form"},on:{open:function(e){arguments[0]=e=t.$handleEvent(e),t.onOpen.apply(void 0,arguments)},closed:function(e){arguments[0]=e=t.$handleEvent(e),t.onClose.apply(void 0,arguments)}},model:{value:t.value.show,callback:function(e){t.$set(t.value,"show",e)},expression:"value.show"}},[a("vk-data-form",{ref:"form1",attrs:{"form-type":t.value.mode,rules:t.form1.props.rules,action:t.form1.props.action,columns:t.form1.props.columns,loading:t.form1.props.loading,labelWidth:t.form1.props.labelWidth,"show-cancel":t.page.showCancel,"cancel-text":t.page.cancelText,"submit-text":t.page.submitText},on:{"update:loading":function(e){arguments[0]=e=t.$handleEvent(e),t.$set(t.form1.props,"loading",e)},success:function(e){arguments[0]=e=t.$handleEvent(e),t.onFormSuccess.apply(void 0,arguments)}},scopedSlots:t._u([{key:"tips",fn:function(e){e.form,e.keyName;return[a("v-uni-view",{staticStyle:{"background-color":"#f4faff",padding:"15px","font-size":"12px","line-height":"24px"}},[a("v-uni-text",[t._v("说明：\n\t\t\t\t\t1. 下载商品导入模板\n\t\t\t\t\t2. 在 [商品导入模板] 工作表按规则添加商品数据，工作表名字禁止修改\n\t\t\t\t\t3. 等待上传结果（请勿关闭此页面）\n\t\t\t\t\t注意:\n\t\t\t\t\t1. 一次上传最多上传1000个商品。（本地运行可突破此限制）\n\t\t\t\t\t2. 系统会以你上传的商品编号作为商品识别码（如果编号为空，则会以商品名称作为商品识别码），如果编号已存在，则此商品不会导入。")])],1)]}}]),model:{value:t.form1.data,callback:function(e){t.$set(t.form1,"data",e)},expression:"form1.data"}})],1)},n=[]},f95a:function(t,e,a){"use strict";var i;a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;uni.vk;var n={props:{value:{type:Object,default:function(){return{show:!1,mode:"",goods_ids:[],categoryList:[]}}}},data:function(){return{page:{title:"批量修改商品分类",submitText:"修改",cancelText:"关闭",showCancel:!0,top:"7vh",width:"600px"},form1:{data:{goods_ids:[],type:1,category_ids:[]},props:{action:"admin/sys.goods.updateCategory",columns:[{key:"type",title:"分类添加方式",type:"radio",data:[{value:1,label:"替代原有分类"},{value:2,label:"新增选中分类"}]},{key:"category_ids",title:"选择分类",type:"cascader",width:600,action:"admin/sys.category.kh_getList",props:{list:"rows",value:"_id",label:"name",children:"children",checkStrictly:!0,emitPath:!1,multiple:!0}}],rules:{},labelWidth:"100px"}}}},mounted:function(){i=this,i.init()},methods:{init:function(){var t=i,e=t.value;i.$emit("input",e)},onOpen:function(){i=this;var t=i.value,e=t.goods_ids;t.categorylist;i.form1.data.goods_ids=e},onClose:function(){},onFormSuccess:function(){i.value.show=!1,i.$emit("success")}},watch:{},computed:{}};e.default=n},fe66:function(t,e,a){"use strict";a.r(e);var i=a("f95a"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a}}]);