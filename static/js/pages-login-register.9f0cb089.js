(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-register"],{"35c3":function(e,t,n){"use strict";n("6a54");var a=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("5ef2"),n("aa9c");var r=a(n("2634")),i=a(n("2fdc")),o=uni.vk,s={data:function(){return{data:{},form1:{agreement:!1,nickname:"",mobile:"",password:"",password2:"",code:"",type:"register",inviteCode:"",avatar:""},scrollTop:0,isRotate:!1,logoImage:"/static/logo.png",uploadList:[]}},onPageScroll:function(e){this.scrollTop=e.scrollTop},onLoad:function(e){o=uni.vk,this.init(e),uni.$on("uAvatarCropper",this.updateAvatar)},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){uni.$off("uAvatarCropper",this.updateAvatar)},onShareAppMessage:function(e){},methods:{init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("init: ",e);var t=o.getVuex("$user.mchInfo.logo");t&&(this.logoImage=t),e.mobile&&(this.form1.mobile=e.mobile),this.form1.inviteCode||(this.form1.inviteCode=o.getVuex("$user.inviteCode"))},pageTo:function(e){o.navigateTo(e)},checkboxChange:function(e){var t=e.detail.value||[];t.length>0&&t[0]?this.form1.agreement=!0:this.form1.agreement=!1},loginBySms:function(){var e=this;return(0,i.default)((0,r.default)().mark((function t(){var n,a,i,s,c,l,u,f,d;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e,!n.isRotate){t.next=3;break}return t.abrupt("return",!1);case 3:if(a=n.form1,i=a.avatar,s=a.agreement,c=a.nickname,l=a.mobile,u=a.code,f=a.password,d=a.password2,s){t.next=7;break}return o.toast("请阅读并同意用户服务及隐私协议"),t.abrupt("return");case 7:if(i){t.next=10;break}return o.toast("头像不能为空"),t.abrupt("return");case 10:if(c){t.next=13;break}return o.toast("昵称不能为空"),t.abrupt("return");case 13:if(o.pubfn.checkStr(l,"mobile")){t.next=16;break}return o.toast("请输入正确的手机号码"),t.abrupt("return");case 16:if(o.pubfn.checkStr(f,"pwd")){t.next=19;break}return o.toast("密码以字母开头，长度在6~18之间，只能包含字母、数字和下划线"),t.abrupt("return");case 19:if(o.pubfn.checkStr(d,"pwd")){t.next=22;break}return o.toast("密码以字母开头，长度在6~18之间，只能包含字母、数字和下划线"),t.abrupt("return");case 22:if(f==d){t.next=25;break}return o.toast("两次密码必须相同!"),t.abrupt("return");case 25:if(o.pubfn.checkStr(u,"mobileCode")){t.next=28;break}return o.toast("验证码格式为6位数字"),t.abrupt("return");case 28:if(-1!=n.uploadList.indexOf(i)){t.next=31;break}return t.next=31,o.uploadFile({title:"上传中...",filePath:i,suffix:"png",success:function(e){n.uploadList.push(e.url),n.form1.avatar=e.url}});case 31:n.isRotate=!0,o.userCenter.loginBySms({data:n.form1,success:function(e){n.isRotate=!1,"login"==e.type?o.toast("登录成功!"):o.toast("注册成功!"),setTimeout((function(){o.setVuex("$user.login.username",l),o.setVuex("$user.login.password",f),o.setVuex("$user.login.savePwd",!0);var e=getCurrentPages();e.length>=2&&e[e.length-2].route&&-1==e[e.length-2].route.indexOf("login")?o.navigateBack():o.navigateToHome()}),1e3)},complete:function(){n.isRotate=!1}});case 33:case"end":return t.stop()}}),t)})))()},onChooseAvatar:function(e){var t=e.detail.avatarUrl;t&&(this.form1.avatar=t)},chooseAvatar:function(){this.$u.route({url:"/uni_modules/vk-uview-ui/components/u-avatar-cropper/u-avatar-cropper",params:{destWidth:300,rectWidth:200,fileType:"jpg"}})},updateAvatar:function(e){var t=this;e.indexOf(";base64,")>-1?o.pubfn.base64ToFile({base64:e,success:function(e){t.form1.avatar=e.path}}):this.form1.avatar=e},userAgreement:function(){this.form1.agreement=!0},openPrivacyContract:function(){var e=this;uni.openPrivacyContract({success:function(){e.isRead=!0},fail:function(e){console.error("err: ",e),uni.showToast({title:"网络错误",icon:"error"})}})}},computed:{}};t.default=s},4651:function(e,t,n){var a=n("7ab6");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var r=n("967d").default;r("634cc37a",a,!0,{sourceMap:!1,shadowMode:!1})},"7ab6":function(e,t,n){var a=n("c86c");t=a(!1),t.push([e.i,".login[data-v-0f1e8738]{--success:#19be6b;\n}.content[data-v-0f1e8738]{display:flex;flex-direction:column;justify-content:center}\r\n\r\n/* 头部 logo 开始 */.header[data-v-0f1e8738]{width:%?160?%;height:%?160?%;box-shadow:%?0?% %?0?% %?60?% %?0?% rgba(0,0,0,.1);border-radius:50%;margin-top:%?40?%;margin-bottom:%?40?%;margin-left:auto;margin-right:auto}.header .logo[data-v-0f1e8738]{width:%?160?%;height:%?160?%;border-radius:50%;border:0}\r\n\r\n/* 头部 logo 结束 */\r\n\r\n/* 表单主体 开始 */.form-view[data-v-0f1e8738]{display:flex;flex-direction:column;padding-left:%?70?%;padding-right:%?70?%}.form-view .form-item[data-v-0f1e8738]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;color:#333;padding:%?24?% %?32?%;margin:%?26?% 0;background-color:#fff}.form-view .form-border[data-v-0f1e8738]{border:none;border-radius:2.5rem;-webkit-box-shadow:0 0 %?60?% 0 rgba(43,86,112,.1);box-shadow:0 0 %?60?% 0 rgba(43,86,112,.1)}.form-view .form-input[data-v-0f1e8738]{flex:1;text-align:left;font-size:%?28?%;padding-right:%?10?%;margin-left:%?20?%;width:100%;min-height:%?70?%}\r\n\r\n/* 表单主体 结束 */\r\n\r\n/* 主体按钮 开始 */.submit-btn[data-v-0f1e8738]{margin-top:%?60?%;width:80%;height:%?100?%;margin-left:auto;margin-right:auto}.submit-btn .btn[data-v-0f1e8738]{height:%?76?%;line-height:%?76?%;font-size:%?30?%;overflow:hidden}.submit-btn .btn.success[data-v-0f1e8738]{background-color:var(--success);color:#fff}.submit-btn .btn.circle[data-v-0f1e8738]{border-radius:%?100?%}.submit-btn .btn.hover[data-v-0f1e8738]{opacity:.7}\r\n\r\n/* 主体按钮 结束 */\r\n\r\n/* 底部 开始*/.footer[data-v-0f1e8738]{display:flex;flex-direction:row;justify-content:center;align-items:center;font-size:%?28?%;margin-top:%?80?%;color:rgba(0,0,0,.7);text-align:center;height:%?40?%;line-height:%?40?%}.footer.bottom[data-v-0f1e8738]{position:absolute;bottom:%?100?%;text-align:center;width:100%}.footer .label[data-v-0f1e8738]{display:flex;align-items:center}.footer .center-line[data-v-0f1e8738]{font-size:%?24?%;margin-left:%?15?%;margin-right:%?15?%}.footer .footer-checkbox[data-v-0f1e8738]{-webkit-transform:scale(.7);transform:scale(.7)}.footer .link[data-v-0f1e8738]{color:var(--success)}\r\n\r\n/* 底部 结束*/\r\n\r\n/* 其他登录开始 */.login-icon-title[data-v-0f1e8738]{width:100%;text-align:center;margin-top:%?50?%;color:rgba(0,0,0,.3);font-size:%?24?%}.login-icon-view[data-v-0f1e8738]{width:100%;text-align:center;margin-top:%?30?%;display:flex;justify-content:center}.login-icon-item[data-v-0f1e8738]{width:%?120?%;display:flex;text-align:center;justify-content:center}\r\n\r\n/* 其他登录结束 */\r\n\r\n/* 登录方式切换 开始 */.login-way-change[data-v-0f1e8738]{display:flex;padding:0 %?80?%;align-items:center;height:%?50?%}.login-way-change .login-way-left .checkbox[data-v-0f1e8738]{-webkit-transform:scale(.7);transform:scale(.7)}.login-way-change .login-way-right[data-v-0f1e8738]{flex:1;text-align:right}\r\n\r\n/* 登录方式切换 结束 */\r\n\r\n/* 手机号授权提示 开始 */.auth-tips[data-v-0f1e8738]{font-size:%?24?%;color:#f85959;text-align:center;margin-top:%?40?%;font-weight:700;\r\n\t/* 增加动画抖动，持续2秒，防止用户没看到提示 */-webkit-animation:shake-data-v-0f1e8738 2s;animation:shake-data-v-0f1e8738 2s}@-webkit-keyframes shake-data-v-0f1e8738{0%{-webkit-transform:translateX(0);transform:translateX(0)}25%{-webkit-transform:translateX(-10px);transform:translateX(-10px)}50%{-webkit-transform:translateX(10px);transform:translateX(10px)}75%{-webkit-transform:translateX(-10px);transform:translateX(-10px)}100%{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes shake-data-v-0f1e8738{0%{-webkit-transform:translateX(0);transform:translateX(0)}25%{-webkit-transform:translateX(-10px);transform:translateX(-10px)}50%{-webkit-transform:translateX(10px);transform:translateX(10px)}75%{-webkit-transform:translateX(-10px);transform:translateX(-10px)}100%{-webkit-transform:translateX(0);transform:translateX(0)}}\r\n\r\n/* 手机号授权提示 结束 */.avatar[data-v-0f1e8738]{width:%?160?%;height:%?160?%;border-radius:50%;margin:0;padding:0;border:1px solid #f8f8f8;display:flex;justify-content:center;align-items:center}",""]),e.exports=t},"7b88":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}));var a={vkDataVerificationCode:n("e98f").default},r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"app register"},[n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{staticClass:"header"},[n("v-uni-button",{staticClass:"avatar",attrs:{plain:!0,"open-type":"chooseAvatar"},on:{chooseavatar:function(t){arguments[0]=t=e.$handleEvent(t),e.onChooseAvatar.apply(void 0,arguments)},click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseAvatar.apply(void 0,arguments)}}},[e.form1.avatar?n("v-uni-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.form1.avatar,mode:"aspectFill",fade:!1}}):n("v-uni-text",[e._v("头像")])],1)],1),n("v-uni-view",{staticClass:"form-view"},[n("v-uni-view",{staticClass:"form-item form-border"},[n("v-uni-input",{staticClass:"form-input",attrs:{type:"text",maxlength:11,placeholder:"手机号","placeholder-style":"'color':'#8e8e8e'"},model:{value:e.form1.mobile,callback:function(t){e.$set(e.form1,"mobile",t)},expression:"form1.mobile"}})],1),n("v-uni-view",{staticClass:"form-item form-border"},[n("v-uni-input",{staticClass:"form-input",attrs:{type:"text",maxlength:20,placeholder:"请输入昵称","placeholder-style":"'color':'#8e8e8e'"},model:{value:e.form1.nickname,callback:function(t){e.$set(e.form1,"nickname",t)},expression:"form1.nickname"}})],1),n("v-uni-view",{staticClass:"form-item form-border"},[n("v-uni-input",{staticClass:"form-input",attrs:{type:"password",placeholder:"请输入新密码","placeholder-style":"'color':'#8e8e8e'"},model:{value:e.form1.password,callback:function(t){e.$set(e.form1,"password",t)},expression:"form1.password"}})],1),n("v-uni-view",{staticClass:"form-item form-border"},[n("v-uni-input",{staticClass:"form-input",attrs:{type:"password",placeholder:"请再次输入新密码","placeholder-style":"'color':'#8e8e8e'"},model:{value:e.form1.password2,callback:function(t){e.$set(e.form1,"password2",t)},expression:"form1.password2"}})],1),n("v-uni-view",{staticClass:"form-item form-border"},[n("v-uni-input",{staticClass:"form-input",attrs:{type:"number",maxlength:6,placeholder:"请输入短信验证码","placeholder-style":"'color':'#8e8e8e'"},model:{value:e.form1.code,callback:function(t){e.$set(e.form1,"code",t)},expression:"form1.code"}}),n("vk-data-verification-code",{attrs:{seconds:"60",mobile:e.form1.mobile,type:"register","custom-style":"font-size: 28rpx;"}})],1),n("v-uni-view",{staticClass:"form-item form-border"},[n("v-uni-input",{staticClass:"form-input",attrs:{type:"text",maxlength:11,placeholder:"邀请码","placeholder-style":"'color':'#8e8e8e'"},model:{value:e.form1.inviteCode,callback:function(t){e.$set(e.form1,"inviteCode",t)},expression:"form1.inviteCode"}})],1)],1),n("v-uni-view",{staticClass:"submit-btn"},[n("v-uni-button",{staticClass:"btn success circle",attrs:{"hover-class":"hover",shape:"circle",plain:!1,"hair-line":!1,type:"success"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.loginBySms.apply(void 0,arguments)}}},[e._v("注 册")])],1),n("v-uni-view",{staticClass:"footer",staticStyle:{"margin-bottom":"100rpx"}},[n("v-uni-label",[n("v-uni-checkbox-group",{on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.checkboxChange.apply(void 0,arguments)}}},[n("v-uni-checkbox",{staticClass:"footer-checkbox",attrs:{value:"true",checked:e.form1.agreement,"active-color":"#737373",shape:"circle"}}),n("v-uni-text",[e._v("同意")])],1)],1),n("v-uni-navigator",{staticClass:"link",attrs:{url:"./agreement","open-type":"navigate"}},[e._v("《用户协议》")])],1)],1)],1)},i=[]},"841e":function(e,t,n){"use strict";n("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("64aa"),n("5c47"),n("a1c1"),n("c223"),n("0506"),n("5ef2");var a={"zh-Hans":{startText:"获取验证码",changeText:"X秒重新获取",endText:"重新获取",tryAgainInSeconds:"秒后再重试",pleaseEnterTheCorrectMobileNumber:"请输入正确的手机号码",sending:"发送中...",verificationCodeSent:"验证码已发送",triggerDayLevelFlowControl:"触发天级流控",pleaseTryAgainTomorrow:"短信发送频繁，请明日再试！",pleaseTryAgainIn1Hour:"短信发送频繁，请过1小时后再试！",triggerMinuteLevelFlowControl:"触发分钟级流控",pleaseTryAgainLater:"短信发送频繁，请稍后再试！"},"zh-Hant":{startText:"獲取驗證碼",changeText:"X秒重新獲取",endText:"重新獲取",tryAgainInSeconds:"秒後再重試",pleaseEnterTheCorrectMobileNumber:"請輸入正確的手機號碼",sending:"發送中...",verificationCodeSent:"驗證碼已發送",triggerDayLevelFlowControl:"觸發天級流控",pleaseTryAgainTomorrow:"短信發送頻繁，請明日再試！",pleaseTryAgainIn1Hour:"短信發送頻繁，請過1小時後再試！",triggerMinuteLevelFlowControl:"觸發分鐘級流控",pleaseTryAgainLater:"短信發送頻繁，請稍後再試！"},en:{startText:"Get code",changeText:"X second reacquire",endText:"Reacquire",tryAgainInSeconds:"Try again in seconds",pleaseEnterTheCorrectMobileNumber:"Please enter the correct mobile number",sending:"Sending...",verificationCodeSent:"Verification code sent",triggerDayLevelFlowControl:"Trigger day level flow control",pleaseTryAgainTomorrow:"SMS sent frequently, please try again tomorrow!",pleaseTryAgainIn1Hour:"SMS sent frequently, please try again in 1 hour",triggerMinuteLevelFlowControl:"Trigger minute level flow control",pleaseTryAgainLater:"SMS sent frequently, please try again later"}},r={name:"vk-data-verification-code",emits:["start","end","change","send","codeChange","error","success"],props:{mode:{type:String,default:"mobile"},mobile:{type:String},type:{type:String,default:"login"},customStyle:{type:[String,Object]},seconds:{type:[String,Number],default:60},startText:{type:String,default:""},changeText:{type:String,default:""},endText:{type:String,default:""},keepRunning:{type:Boolean,default:!1},uniqueKey:{type:String,default:""},checkUserExist:{type:Boolean,default:!1}},data:function(){return{secNum:this.seconds,timer:null,canGetCode:!0,tips:"",locale:{}}},created:function(){if("undefined"!==typeof vk){var e=vk.pubfn.getLocale();this.locale=a[e]}else this.locale=a["zh-Hans"]},mounted:function(){this.checkKeepRunning()},watch:{seconds:{immediate:!0,handler:function(e){this.secNum=e}}},computed:{startTextCom:function(){return this.startText||this.locale.startText||"获取验证码"},changeTextCom:function(){return this.changeText||this.locale.changeText||"X秒重新获取"},endTextCom:function(){return this.endText||this.locale.endText||"重新获取"}},methods:{checkKeepRunning:function(){var e=Number(uni.getStorageSync(this.uniqueKey+"_$uCountDownTimestamp"));if(!e)return this.changeEvent(this.startTextCom);var t=Math.floor(+new Date/1e3);this.keepRunning&&e&&e>t?(this.secNum=e-t,uni.removeStorageSync(this.uniqueKey+"_$uCountDownTimestamp"),this.start()):this.changeEvent(this.startTextCom)},start:function(){var e=this;this.timer&&(clearInterval(this.timer),this.timer=null),this.$emit("start"),this.canGetCode=!1,this.changeEvent(this.changeTextCom.replace(/x|X/,this.secNum)),this.setTimeToStorage(),this.timer=setInterval((function(){--e.secNum?e.changeEvent(e.changeTextCom.replace(/x|X/,e.secNum)):(clearInterval(e.timer),e.timer=null,e.changeEvent(e.endTextCom),e.secNum=e.seconds,e.$emit("end"),e.canGetCode=!0)}),1e3)},reset:function(e){this.canGetCode=!0,clearInterval(this.timer),this.secNum=this.seconds,this.changeEvent(e||this.endTextCom)},changeEvent:function(e){this.codeChange(e),this.$emit("change",e)},setTimeToStorage:function(){if(this.keepRunning&&this.timer&&this.secNum>0&&this.secNum<=this.seconds){var e=Math.floor(+new Date/1e3);uni.setStorage({key:this.uniqueKey+"_$uCountDownTimestamp",data:e+Number(this.secNum)})}},codeChange:function(e){this.tips=e,this.$emit("codeChange",e)},sendSmsCode:function(){var e=this,t=uni.vk,n=e.mobile,a=e.type,r=e.canGetCode,i=e.checkUserExist,o=e.secNum,s=e.mode;r?"custom"!==s?t.pubfn.test(n,"mobile")?(e.tips=e.locale.sending,t.userCenter.sendSmsCode({needAlert:!1,data:{mobile:n,type:a,checkUserExist:i},success:function(n){t.toast(e.locale.verificationCodeSent),e.start(),e.$emit("success",n)},fail:function(n){e.tips=e.startTextCom,n.errMsg&&n.errMsg.indexOf("触发天级流控")>-1?t.alert(e.locale.pleaseTryAgainTomorrow,(function(){e.$emit("error",n)})):n.errMsg&&n.errMsg.indexOf("触发小时级流控")>-1?t.alert(e.locale.pleaseTryAgainIn1Hour,(function(){e.$emit("error",n)})):n.errMsg&&n.errMsg.indexOf("触发分钟级流控")>-1?t.alert(e.locale.pleaseTryAgainLater,(function(){e.$emit("error",n)})):n.msg?t.alert(n.msg,(function(){e.$emit("error",n)})):t.alert(e.locale.pleaseTryAgainLater,(function(){e.$emit("error",n)}))}})):t.toast(e.locale.pleaseEnterTheCorrectMobileNumber,"none"):e.$emit("send",{type:a}):t.toast("".concat(o).concat(e.locale.tryAgainInSeconds),"none")}},beforeDestroy:function(){this.setTimeToStorage(),clearTimeout(this.timer),this.timer=null}};t.default=r},"84fb":function(e,t,n){"use strict";n.r(t);var a=n("841e"),r=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},"89ba":function(e,t,n){"use strict";var a=n("4651"),r=n.n(a);r.a},"8b16":function(e,t,n){"use strict";n.r(t);var a=n("35c3"),r=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=r.a},dcef:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){}));var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"vk-data-verification-code"},[n("v-uni-view",{style:e.customStyle,on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.sendSmsCode.apply(void 0,arguments)}}},[e._t("default",[e._v(e._s(e.tips))],{tips:e.tips,secNum:e.secNum})],2)],1)},r=[]},e98f:function(e,t,n){"use strict";n.r(t);var a=n("dcef"),r=n("84fb");for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);var o=n("828b"),s=Object(o["a"])(r["default"],a["b"],a["c"],!1,null,"62ae01f8",null,!1,a["a"],void 0);t["default"]=s.exports},ff92:function(e,t,n){"use strict";n.r(t);var a=n("7b88"),r=n("8b16");for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("89ba");var o=n("828b"),s=Object(o["a"])(r["default"],a["b"],a["c"],!1,null,"0f1e8738",null,!1,a["a"],void 0);t["default"]=s.exports}}]);